/*!
  * jQuery pinify Plugin v1.3
  * http://ie9ify.codeplex.com
  *
  * Copyright 2011, Brandon Satrom and Clark Sell
  * Licensed under an Apache Foundation License.
  * http://github.com/bsatrom/pinify
  *
  * Date: Thursday February 02 2012 12:44:28 -06
  */((function(){var a=Object.prototype.hasOwnProperty;(function(b){var c,d,e,f;return d=function(a,c,d){if(b("meta[name="+a+"]").length&&a!=="msapplication-task")return;if(!c.length)return;return b("<meta>",{name:a,content:c}).appendTo(d)},f=function(){return!!window.external&&"msIsSiteMode"in window.external},c=function(a,b){try{return a()}catch(c){return b}},e={init:function(a){var c;return c={applicationName:document.title.toString(),favIcon:"http://"+location.host+"/favicon.ico",navColor:"",startUrl:"http://"+location.host,tooltip:document.title.toString(),window:"width=800;height=600",target:"",tasks:[]},a=b.extend({},c,a),this.each(function(){var c,e;return e=a.tasks,c=this,b("link[type^=image]").length===0&&b("<link />",{rel:"shortcut icon",type:"image/ico",href:a.favIcon}).appendTo(this),d("application-name",a.applicationName,this),d("msapplication-tooltip",a.tooltip,this),d("msapplication-starturl",a.startUrl,this),d("msapplication-navbutton-color",a.navColor,this),d("msapplication-window",a.window,this),b.each(e,function(a,b){return d("msapplication-task","name="+b.name+";action-uri="+b.action+";icon-uri="+b.icon+";window-type="+b.target,c)})})},enablePinning:function(a){return this.each(function(){return a=a||"Drag this image to your Windows 7 Taskbar to pin this site with IE9",b(this).addClass("msPinSite").attr({title:a})})},enableSiteMode:function(a){return a=a||"click",this.each(function(){return b(this).bind(a,function(a){a.preventDefault();try{return window.external.msAddSiteMode()}catch(b){}})})},pinTeaser:function(a){var c,d,e;return window.external.msIsSiteMode()&&this,e=b(this),d={type:"hangingChad",icon:document.location.pathname.slice(0,document.location.pathname.lastIndexOf("/"))+"/favicon.ico",pinText:"Drag this image to the taskbar to pin this site",secondaryText:"Simply drag the icon or tab to the taskbar to pin.",addStartLink:!1,linkText:"Click here to add this site to the start menu",sticky:!0,timeout:1e3,style:{linkColor:"rgb(0, 108, 172)",backgroundColor:"rgb(0, 108, 172)",textColor:"white",backgroundImage:null,leftBackgroundImage:null,rightBackgroundImage:null,closeButtonImage:null}},c={topHat:function(){var c,d;return e.addClass("pinify-topHat-container pinify-teaser").css("color",a.style.textColor),a.style.backgroundImage&&e.css("background-image",a.style.backgroundImage),c=b("<div>",{"class":"pinify-topHat-alignment"}).appendTo(e),d=b("<div>",{"class":"pinify-topHat-content"}).appendTo(c),b("<img>",{id:"pinify-topHat-logo",src:a.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(d),b("<span>").addClass("pinify-topHat-text").text(a.pinText).appendTo(d)},brandedTopHat:function(){var c;return e.addClass("pinify-brandedTopHat-container pinify-teaser").css("color",a.style.textColor),a.style.backgoundImage&&e.css("background-image",a.style.backgroundImage),c=b("<div>",{"class":"pinify-brandedTopHat-content"}).appendTo(e),b("<img>",{id:"pinify-brandedTopHat-firstLogo",src:a.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(c),b("<img>",{id:"pinify-brandedTopHat-secondLogo",src:a.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(c),b("<img>",{id:"pinify-brandedTopHat-thirdLogo",src:a.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(c),b("<div>",{"class":"pinify-mainText"}).text(a.pinText).appendTo(c),b("<div>",{"class":"pinify-brandedTopHat-secondaryText"}).text(a.secondaryText).appendTo(c)},doubleTopHat:function(){var c,d,f,g;return e.addClass("pinify-doubleTopHat-container pinify-teaser").css("color",a.style.textColor),d=b("<div>",{"class":"pinify-doubleTopHat-left"}).appendTo(e),a.style.leftBackgroundImage&&b(d).css("background-image",a.style.leftBackgoundImage),c=b("<div>",{id:"pinify-doubleTopHat-leftBar"}).appendTo(d),b("<img>",{id:"pinify-doubleTopHat-logo",src:a.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(c),g=b("<div>",{"class":"pinify-doubleTopHat-right"}).appendTo(e),a.style.rightBackgroundImage&&b(g).css("background-image",a.style.rightBackgoundImage),b("<div>",{id:"pinify-doubleTopHat-rightBar"}).appendTo(g),f=b("<div>",{id:"pinify-doubleTopHat-rightBarMainContent"}).appendTo(g),b("<div>",{"class":"pinify-mainText"}).text(a.pinText).appendTo(f),b("<div>",{"class":"pinify-doubleTopHat-lighterText"}).text(a.secondaryText).appendTo(g)},hangingChad:function(){return e.hide(),e.css({color:a.style.textColor,"background-color":a.style.backgroundColor}).addClass("pinify-hanging-container pinify-teaser"),b("<img>",{src:a.icon,"class":"msPinSite"}).appendTo(e),b("<div>",{"class":"pinify-hanging-content"}).appendTo(e),b("<div>",{id:"pinify-pinText"}).text(a.pinText).appendTo(e),e.fadeIn("slow")}},a=b.extend({},d,a),this.each(function(){c[a.type](),a.sticky?b("<div>").addClass("pinify-closePin").click(function(){return b(".pinify-teaser").slideUp("slow"),e.slideUp("slow")}).appendTo(e):this.delay(a.timeout).fadeOut("slow");if(!a.addStartLink)return;return b("<a>").addClass("pinify-addSiteLink").attr("href","#").click(function(a){a.preventDefault();try{return window.external.msAddSiteMode()}catch(b){}}).css("color",a.linkColor).appendTo(e).text(a.linkText)})}},b.fn.pinify=function(a){return f()?e[a]?e[a].apply(this,Array.prototype.slice.call(arguments,1)):typeof a=="object"||!a?e.init.apply(this,arguments):b.error("Method "+a+" does not exist on jQuery.pinify"):this},b.pinify={firstRunState:function(a){return f()?(a&&(a=!1),c(function(){return window.external.msIsSiteModeFirstRun(a)},0)):0},isPinned:function(){return f()?c(function(){return window.external.msIsSiteMode()},!1):!1},addJumpList:function(a){var d;return f()?(d={title:"",items:[]},a=b.extend({},d,a),c(function(){var c;if(window.external.msIsSiteMode())return window.external.msSiteModeClearJumpList(),window.external.msSiteModeCreateJumpList(a.title),c=a.items,b.each(c,function(a,b){return window.external.msSiteModeAddJumpListItem(b.name,b.url,b.icon,b.target)}),window.external.msSiteModeShowJumpList()})):!1},clearJumpList:function(){return f()?c(function(){if(window.external.msIsSiteMode())return window.external.msSiteModeClearJumpList()}):this},addOverlay:function(a){var d;return f()?(d={title:"",icon:""},a=b.extend({},d,a),c(function(){if(window.external.msIsSiteMode())return window.external.msSiteModeClearIconOverlay(),window.external.msSiteModeSetIconOverlay(a.icon,a.title)})):this},clearOverlay:function(){return f()?c(function(){if(window.external.msIsSiteMode())return window.external.msSiteModeClearIconOverlay()}):this},flashTaskbar:function(){return f()?c(function(){if(window.external.msIsSiteMode())return window.external.msSiteModeActivate()}):this},createThumbbarButtons:function(d){var e;return f()?(e={buttons:[]},d=b.extend({},e,d),c(function(){var c,e,f;if(window.external.msIsSiteMode())return e=[],c=function(){function a(){}return a.prototype.button=null,a.prototype.alternateStyle=null,a.prototype.activeStyle=0,a.prototype.click=null,a.prototype.hidden=!1,a}(),f=function(a){var b,c;b=e[a.buttonID],b.click();if(b.alternateStyle)return c=b.activeStyle===0?b.alternateStyle:0,window.external.msSiteModeShowButtonStyle(b.button,c),b.activeStyle=c},b.each(d.buttons,function(a,b){var d,g,h,i;g=window.external.msSiteModeAddThumbBarButton(b.icon,b.name),b.alternateStyle&&(i=b.alternateStyle,d=window.external.msSiteModeAddButtonStyle(g,i.icon,i.name)),h=new c,h.button=g,h.alternateStyle=d,h.click=b.click,h.hidden=b.hidden||!1,e[g]=h;if(document.addEventListener)return document.addEventListener("msthumbnailclick",f,!1);if(document.attachEvent)return document.attachEvent("onmsthumbnailclick",f)}),window.onunload=function(){var b,c,d;d=[];for(b in e){if(!a.call(e,b))continue;c=e[b],d.push(window.external.msSiteModeUpdateThumbBarButton(c.button,!0,!1))}return d},window.onload=function(){var b,c,d;d=[];for(b in e){if(!a.call(e,b))continue;c=e[b],d.push(c.hidden?void 0:window.external.msSiteModeUpdateThumbBarButton(c.button,!0,!0))}return d},window.external.msSiteModeShowThumbBar()})):this}}})(jQuery)})).call(this);