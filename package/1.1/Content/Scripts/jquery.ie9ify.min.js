/*
* jQuery ie9ify Plugin v1.1
* http://ie9ify.codeplex.com
*
* Copyright 2011, Brandon Satrom and Clark Sell
* Licensed under MS-PL.
* http://ie9ify.codeplex.com/license
*
* Date: Friday Apr 15 2011 15:22:23 -05
*/
(function(d){var b={init:function(f){var e={applicationName:document.title.toString(),favIcon:"http://"+location.host+"/favicon.ico",navColor:"",startUrl:"http://"+location.host,tooltip:document.title.toString(),window:"width=800;height=600",tasks:[]};f=d.extend({},e,f);return this.each(function(){if(d("link[type^=image]").length===0){d("<link>").attr("rel","shortcut icon").attr("type","image/ico").attr("href",f.favIcon).appendTo(this)}c("application-name",f.applicationName,this);c("msapplication-tooltip",f.tooltip,this);c("msapplication-starturl",f.startUrl,this);c("msapplication-navbutton-color",f.navColor,this);c("msapplication-window",f.window,this);var h=f.tasks;var g=this;d.each(h,function(i,j){c("msapplication-task","name="+j.name+";action-uri="+j.action+";icon-uri="+j.icon,g)})})},enablePinning:function(e){return this.each(function(){if(e===undefined){e="Drag this image to your Windows 7 Taskbar to pin this site with IE9"}d(this).addClass("msPinSite").attr("title",e)})},enableSiteMode:function(e){if(!e){e="click"}return this.each(function(){d(this).bind(e,function(f){f.preventDefault();try{window.external.msAddSiteMode()}catch(g){}})})},pinTeaser:function(f){if(window.external.msIsSiteMode()){return this}var e={type:"hangingChad",icon:"http://"+location.host+"/favicon.ico",pinText:"Drag this image to the taskbar to pin this site",secondaryText:"Simply drag the icon or tab to taskbar to pin.",addStartLink:true,linkText:"Click here to add this site to the start menu",sticky:true,timeout:10000,style:{linkColor:"rgb(0, 108, 172)",backgroundColor:"rgb(0, 108, 172)",textColor:"white",backgroundImage:null,leftBackgoundImage:null,rightBackgoundImage:null,closeButtonImage:null}};f=d.extend({},e,f);return this.each(function(){switch(f.type){case"topHat":d(this).addClass("ie9ify-topHat-container ie9ify-teaser").css("color",f.style.textColor);if(f.style.backgoundImage){d(this).css("background-image",f.style.backgroundImage)}var m=d("<div>").addClass("ie9ify-topHat-alignment").appendTo(d(this));var i=d("<div>").addClass("ie9ify-topHat-content").appendTo(m);d("<img>").attr("id","ie9ify-topHat-logo").attr("src",f.icon).attr("alt","Drag Me").addClass("msPinSite").appendTo(i);d("<span>").addClass("ie9ify-topHat-text").attr("innerText",f.pinText).appendTo(i);break;case"brandedTopHat":d(this).addClass("ie9ify-brandedTopHat-container ie9ify-teaser").css("color",f.style.textColor);if(f.style.backgoundImage){d(this).css("background-image",f.style.backgroundImage)}var i=d("<div>").addClass("ie9ify-brandedTopHat-content").appendTo(d(this));d("<img>").attr("id","ie9ify-brandedTopHat-firstLogo").attr("src",f.icon).attr("alt","Drag Me").addClass("msPinSite").appendTo(i);d("<img>").attr("id","ie9ify-brandedTopHat-thirdLogo").attr("src",f.icon).attr("alt","Drag Me").addClass("msPinSite").appendTo(i);d("<div>").addClass("ie9ify-mainText").attr("innerText",f.pinText).appendTo(i);d("<div>").addClass("ie9ify-brandedTopHat-secondaryText").attr("innerText",f.secondaryText).appendTo(i);break;case"doubleTopHat":d(this).addClass("ie9ify-doubleTopHat-container ie9ify-teaser").css("color",f.style.textColor);var l=d("<div>").addClass("ie9ify-doubleTopHat-left").appendTo(d(this));if(f.style.leftBackgroundImage){d(l).css("background-image",f.style.leftBackgoundImage)}var h=d("<div>").attr("id","ie9ify-doubleTopHat-leftBar").appendTo(l);d("<img>").attr("id","ie9ify-doubleTopHat-logo").attr("src",f.icon).attr("alt","Drag Me").addClass("msPinSite").appendTo(h);var o=d("<div>").addClass("ie9ify-doubleTopHat-right").appendTo(d(this));if(f.style.rightBackgroundImage){d(o).css("background-image",f.style.rightBackgoundImage)}d("<div>").attr("id","ie9ify-doubleTopHat-rightBar").appendTo(o);var j=d("<div>").attr("id","ie9ify-doubleTopHat-rightBarMainContent").appendTo(o);d("<div>").attr("class","ie9ify-mainText").attr("innerText",f.pinText).appendTo(j);d("<div>").attr("class","ie9ify-doubleTopHat-lighterText").attr("innerText",f.secondaryText).appendTo(o);break;default:d(this).hide();d(this).addClass("ie9ify-hanging-container ie9ify-teaser").css("color",f.style.textColor).css("background-color",f.style.backgroundColor);var k=d("<img>").attr("src",f.icon).addClass("msPinSite").appendTo(this);var g=d("<div>").addClass("ie9ify-hanging-content").appendTo(d(this));var n=d("<div>").attr("id","ie9ify-pinText").attr("innerText",f.pinText).appendTo(this);d(this).fadeIn("slow");break}if(!f.sticky){d(this).delay(f.timeout).fadeOut("slow")}else{d("<div>").addClass("ie9ify-closePin").click(function(){d(".ie9ify-teaser").slideUp("slow");d(this).slideUp("slow")}).appendTo(this)}if(!f.addStartLink){return}link=d("<a>").addClass("ie9ify-addSiteLink").attr("href","#").click(function(p){p.preventDefault();try{window.external.msAddSiteMode()}catch(q){}}).css("color",f.linkColor).appendTo(g).text(f.linkText)})}};d.fn.ie9ify=function(e){if(!a()){return this}if(b[e]){return b[e].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof e==="object"||!e){return b.init.apply(this,arguments)}else{d.error("Method "+e+" does not exist on jQuery.ie9ify")}}};d.ie9ify={};d.ie9ify.firstRunState=function(f){if(!a()){return 0}if(f==undefined){f=false}try{return window.external.msIsSiteModeFirstRun(f)}catch(g){return 0}};d.ie9ify.isPinned=function(){if(!a()){return false}try{return window.external.msIsSiteMode()}catch(f){return false}};d.ie9ify.addJumpList=function(h){if(!a()){return this}var f={title:"",items:[]};h=d.extend({},f,h);try{if(window.external.msIsSiteMode()){window.external.msSiteModeClearJumplist();window.external.msSiteModeCreateJumplist(h.title);var g=h.items;d.each(g,function(e,j){window.external.msSiteModeAddJumpListItem(j.name,j.url,j.icon)});window.external.msSiteModeShowJumplist()}}catch(i){}return this};d.ie9ify.clearJumpList=function(){if(!a()){return this}try{if(window.external.msIsSiteMode()){window.external.msSiteModeClearJumpList()}}catch(f){}};d.ie9ify.addOverlay=function(g){if(!a()){return this}var f={eventName:"click",title:"",icon:""};g=d.extend({},f,g);try{if(window.external.msIsSiteMode()){window.external.msSiteModeClearIconOverlay();window.external.msSiteModeSetIconOverlay(g.icon,g.title)}}catch(h){}};d.ie9ify.clearOverlay=function(){if(!a()){return this}try{if(window.external.msIsSiteMode()){window.external.msSiteModeClearIconOverlay()}}catch(f){}};d.ie9ify.flashTaskbar=function(f){if(!a()){return this}try{if(window.external.msIsSiteMode()){window.external.msSiteModeActivate()}}catch(g){}};d.ie9ify.createThumbbarButtons=function(i){if(!a()){return this}var g={buttons:[]};i=d.extend({},g,i);try{if(window.external.msIsSiteMode()){var j=new Array();function f(){}f.prototype.button=null;f.prototype.alternateStyle=null;f.prototype.activeStyle=0;f.prototype.click=null;var h=function(e){var m=j[e.buttonID];m.click();if(m.alternateStyle){var l=m.activeStyle==0?m.alternateStyle:0;window.external.msSiteModeShowButtonStyle(m.button,l);m.activeStyle=l}};d.each(i.buttons,function(l,o){var e=window.external.msSiteModeAddThumbBarButton(o.icon,o.name);var n;if(o.alternateStyle){var m=o.alternateStyle;n=window.external.msSiteModeAddButtonStyle(e,m.icon,m.name)}buttonStyle=new f();buttonStyle.button=e;buttonStyle.alternateStyle=n;buttonStyle.click=o.click;j[e]=buttonStyle;if(document.addEventListener){document.addEventListener("msthumbnailclick",h,false)}else{if(document.attachEvent){document.attachEvent("onmsthumbnailclick",h)}}});window.onunload=function(){for(key in j){window.external.msSiteModeUpdateThumbBarButton(j[key].button,true,false)}};window.onload=function(){for(key in j){window.external.msSiteModeUpdateThumbBarButton(j[key].button,true,true)}};window.external.msSiteModeShowThumbBar()}}catch(k){}};function c(e,g,f){if(d("meta[name="+e+"]").length&&e!="msapplication-task"){return}if(g.length===0){return}d("<meta>").attr("name",e).attr("content",g).appendTo(f)}function a(){return(!!window.external)&&("msIsSiteMode" in window.external)}})(jQuery);