(function(){var a=Object.prototype.hasOwnProperty;(function(b){var c,d,e,f;d=function(a,c,d){if(b("meta[name="+a+"]").length&&a!=="msapplication-task"){return}if(!c.length){return}return b("<meta>",{name:a,content:c}).appendTo(d)};f=function(){return!!window.external&&"msIsSiteMode"in window.external};c=function(a,b){try{return a()}catch(c){return b}};e={init:function(a){var c;c={applicationName:document.title.toString(),favIcon:"http://"+location.host+"/favicon.ico",navColor:"",startUrl:"http://"+location.host,tooltip:document.title.toString(),window:"width=800;height=600",tasks:[]};a=b.extend({},c,a);return this.each(function(){var c,e;e=a.tasks;c=this;if(b("link[type^=image]").length===0){b("<link />",{rel:"shortcut icon",type:"image/ico",href:a.favIcon}).appendTo(this)}d("application-name",a.applicationName,this);d("msapplication-tooltip",a.tooltip,this);d("msapplication-starturl",a.startUrl,this);d("msapplication-navbutton-color",a.navColor,this);d("msapplication-window",a.window,this);return b.each(e,function(a,b){return d("msapplication-task","name="+b.name+";action-uri="+b.action+";icon-uri="+b.icon,c)})})},enablePinning:function(a){return this.each(function(){a=a||"Drag this image to your Windows 7 Taskbar to pin this site with IE9";return b(this).addClass("msPinSite").attr({title:a})})},enableSiteMode:function(a){a=a||"click";return this.each(function(){return b(this).bind(a,function(a){a.preventDefault();try{return window.external.msAddSiteMode()}catch(b){}})})},pinTeaser:function(a){var c,d,e;if(window.external.msIsSiteMode()){this}e=b(this);d={type:"hangingChad",icon:"http://"+location.host+"/favicon.ico",pinText:"Drag this image to the taskbar to pin this site",secondaryText:"Simply drag the icon or tab to the taskbar to pin.",addStartLink:false,linkText:"Click here to add this site to the start menu",sticky:true,timeout:1e3,style:{linkColor:"rgb(0, 108, 172)",backgroundColor:"rgb(0, 108, 172)",textColor:"white",backgroundImage:null,leftBackgroundImage:null,rightBackgroundImage:null,closeButtonImage:null}};c={topHat:function(){var c,d;e.addClass("pinify-topHat-container pinify-teaser").css("color",a.style.textColor);if(a.style.backgroundImage){e.css("background-image",a.style.backgroundImage)}c=b("<div>",{"class":"pinify-topHat-alignment"}).appendTo(e);d=b("<div>",{"class":"pinify-topHat-content"}).appendTo(c);b("<img>",{id:"pinify-topHat-logo",src:a.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(d);return b("<span>").addClass("pinify-topHat-text").text(a.pinText).appendTo(d)},brandedTopHat:function(){var c;e.addClass("pinify-brandedTopHat-container pinify-teaser").css("color",a.style.textColor);if(a.style.backgoundImage){e.css("background-image",a.style.backgroundImage)}c=b("<div>",{"class":"pinify-brandedTopHat-content"}).appendTo(e);b("<img>",{id:"pinify-brandedTopHat-firstLogo",src:a.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(c);b("<img>",{id:"pinify-brandedTopHat-thirdLogo",src:a.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(c);b("<div>",{"class":"pinify-mainText"}).text(a.pinText).appendTo(c);return b("<div>",{"class":"pinify-brandedTopHat-secondaryText"}).text(a.secondaryText).appendTo(c)},doubleTopHat:function(){var c,d,f,g;e.addClass("pinify-doubleTopHat-container pinify-teaser").css("color",a.style.textColor);d=b("<div>",{"class":"pinify-doubleTopHat-left"}).appendTo(e);if(a.style.leftBackgroundImage){b(d).css("background-image",a.style.leftBackgoundImage)}c=b("<div>",{id:"pinify-doubleTopHat-leftBar"}).appendTo(d);b("<img>",{id:"pinify-doubleTopHat-logo",src:a.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(c);g=b("<div>",{"class":"pinify-doubleTopHat-right"}).appendTo(e);if(a.style.rightBackgroundImage){b(g).css("background-image",a.style.rightBackgoundImage)}b("<div>",{id:"pinify-doubleTopHat-rightBar"}).appendTo(g);f=b("<div>",{id:"pinify-doubleTopHat-rightBarMainContent"}).appendTo(g);b("<div>",{"class":"pinify-mainText"}).text(a.pinText).appendTo(f);return b("<div>",{"class":"pinify-doubleTopHat-lighterText"}).text(a.secondaryText).appendTo(g)},hangingChad:function(){e.hide();e.css({color:a.style.textColor,"background-color":a.style.backgroundColor}).addClass("pinify-hanging-container pinify-teaser");b("<img>",{src:a.icon,"class":"msPinSite"}).appendTo(e);b("<div>",{"class":"pinify-hanging-content"}).appendTo(e);b("<div>",{id:"pinify-pinText"}).text(a.pinText).appendTo(e);return e.fadeIn("slow")}};a=b.extend({},d,a);return this.each(function(){c[a.type]();if(!a.sticky){this.delay(a.timeout).fadeOut("slow")}else{b("<div>").addClass("pinify-closePin").click(function(){b(".pinify-teaser").slideUp("slow");return e.slideUp("slow")}).appendTo(e)}if(!a.addStartLink){return}return b("<a>").addClass("pinify-addSiteLink").attr("href","#").click(function(a){a.preventDefault();try{return window.external.msAddSiteMode()}catch(b){}}).css("color",a.linkColor).appendTo(e).text(a.linkText)})}};b.fn.pinify=function(a){if(!f()){return this}if(e[a]){return e[a].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof a==="object"||!a){return e.init.apply(this,arguments)}else{return b.error("Method "+a+" does not exist on jQuery.pinify")}};return b.pinify={firstRunState:function(a){if(!f()){return 0}if(a){a=false}return c(function(){return window.external.msIsSiteModeFirstRun(a)},0)},isPinned:function(){if(!f()){return false}return c(function(){return window.external.msIsSiteMode()},false)},addJumpList:function(a){var d;if(!f()){return false}d={title:"",items:[]};a=b.extend({},d,a);return c(function(){var c;if(window.external.msIsSiteMode()){window.external.msSiteModeClearJumpList();window.external.msSiteModeCreateJumpList(a.title);c=a.items;b.each(c,function(a,b){return window.external.msSiteModeAddJumpListItem(b.name,b.url,b.icon)});return window.external.msSiteModeShowJumpList()}})},clearJumpList:function(){if(!f()){return this}return c(function(){if(window.external.msIsSiteMode()){return window.external.msSiteModeClearJumpList()}})},addOverlay:function(a){var d;if(!f()){return this}d={title:"",icon:""};a=b.extend({},d,a);return c(function(){if(window.external.msIsSiteMode()){window.external.msSiteModeClearIconOverlay();return window.external.msSiteModeSetIconOverlay(a.icon,a.title)}})},clearOverlay:function(){if(!f()){return this}return c(function(){if(window.external.msIsSiteMode()){return window.external.msSiteModeClearIconOverlay()}})},flashTaskbar:function(){if(!f()){return this}return c(function(){if(window.external.msIsSiteMode()){return window.external.msSiteModeActivate()}})},createThumbbarButtons:function(d){var e;if(!f()){return this}e={buttons:[]};d=b.extend({},e,d);return c(function(){var c,e,f;if(window.external.msIsSiteMode()){e=[];c=function(){function a(){}a.prototype.button=null;a.prototype.alternateStyle=null;a.prototype.activeStyle=0;a.prototype.click=null;a.prototype.hidden=false;return a}();f=function(a){var b,c;b=e[a.buttonID];b.click();if(b.alternateStyle){c=b.activeStyle===0?b.alternateStyle:0;window.external.msSiteModeShowButtonStyle(b.button,c);return b.activeStyle=c}};b.each(d.buttons,function(a,b){var d,g,h,i;g=window.external.msSiteModeAddThumbBarButton(b.icon,b.name);if(b.alternateStyle){i=b.alternateStyle;d=window.external.msSiteModeAddButtonStyle(g,i.icon,i.name)}h=new c;h.button=g;h.alternateStyle=d;h.click=b.click;h.hidden=b.hidden||false;e[g]=h;if(document.addEventListener){return document.addEventListener("msthumbnailclick",f,false)}else if(document.attachEvent){return document.attachEvent("onmsthumbnailclick",f)}});window.onunload=function(){var b,c,d;d=[];for(b in e){if(!a.call(e,b))continue;c=e[b];d.push(window.external.msSiteModeUpdateThumbBarButton(c.button,true,false))}return d};window.onload=function(){var b,c,d;d=[];for(b in e){if(!a.call(e,b))continue;c=e[b];d.push(!c.hidden?window.external.msSiteModeUpdateThumbBarButton(c.button,true,true):void 0)}return d};return window.external.msSiteModeShowThumbBar()}})}}})(jQuery)}).call(this)