var __hasProp=Object.prototype.hasOwnProperty;(function(d){var e,c,b,a;c=function(f,h,g){if(d("meta[name="+f+"]").length&&f!=="msapplication-task"){return}if(!h.length){return}return d("<meta>",{name:f,content:h}).appendTo(g)};a=function(){return(!!window.external)&&("msIsSiteMode" in window.external)};e=function(g,f){try{return g()}catch(h){return f}};b={init:function(g){var f;f={applicationName:document.title.toString(),favIcon:"http://"+location.host+"/favicon.ico",navColor:"",startUrl:"http://"+location.host,tooltip:document.title.toString(),window:"width=800;height=600",tasks:[]};g=d.extend({},f,g);return this.each(function(){var i,h;h=g.tasks;i=this;if(d("link[type^=image]").length===0){d("<link />",{rel:"shortcut icon",type:"image/ico",href:g.favIcon}).appendTo(this)}c("application-name",g.applicationName,this);c("msapplication-tooltip",g.tooltip,this);c("msapplication-starturl",g.startUrl,this);c("msapplication-navbutton-color",g.navColor,this);c("msapplication-window",g.window,this);return d.each(h,function(j,k){return c("msapplication-task","name="+k.name+";action-uri="+k.action+";icon-uri="+k.icon,i)})})},enablePinning:function(f){return this.each(function(){f=f||"Drag this image to your Windows 7 Taskbar to pin this site with IE9";return d(this).addClass("msPinSite").attr({title:f})})},enableSiteMode:function(f){f=f||"click";return this.each(function(){return d(this).bind(f,function(g){g.preventDefault();try{return window.external.msAddSiteMode()}catch(h){}})})},pinTeaser:function(h){var g,f,i;if(window.external.msIsSiteMode()){this}i=d(this);f={type:"hangingChad",icon:"http://"+location.host+"/favicon.ico",pinText:"Drag this image to the taskbar to pin this site",secondaryText:"Simply deag the icon or tab to the taskbar to pin.",addStartLink:false,linkText:"Click here to add this site to the start menu",sticky:true,timeout:1000,style:{linkColor:"rgb(0, 108, 172)",backgroundColor:"rgb(0, 108, 172)",textColor:"white",backgroundImage:null,leftBackgroundImage:null,rightBackgroundImage:null,closeButtonImage:null}};g={topHat:function(){var k,j;i.addClass("pinify-topHat-container pinify-teaser").css("color",h.style.textColor);if(h.style.backgroundImage){i.css("background-image",h.style.backgroundImage)}k=d("<div>",{"class":"pinify-topHat-alignment"}).appendTo(i);j=d("<div>",{"class":"pinify-topHat-content"}).appendTo(k);d("<img>",{id:"pinify-topHat-logo",src:h.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(j);return d("<span>").addClass("pinify-topHat-text").text(h.pinText).appendTo(j)},brandedTopHat:function(){var j;i.addClass("pinify-brandedTopHat-container pinify-teaser").css("color",h.style.textColor);if(h.style.backgoundImage){i.css("background-image",h.style.backgroundImage)}j=d("<div>",{"class":"pinify-brandedTopHat-content"}).appendTo(i);d("<img>",{id:"pinify-brandedTopHat-firstLogo",src:h.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(j);d("<img>",{id:"pinify-brandedTopHat-thirdLogo",src:h.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(j);d("<div>",{"class":"pinify-mainText"}).text(h.pinText).appendTo(j);return d("<div>",{"class":"pinify-brandedTopHat-secondaryText"}).text(h.secondaryText).appendTo(j)},doubleTopHat:function(){var j,l,k,m;i.addClass("pinify-doubleTopHat-container pinify-teaser").css("color",h.style.textColor);l=d("<div>",{"class":"pinify-doubleTopHat-left"}).appendTo(i);if(h.style.leftBackgroundImage){d(l).css("background-image",h.style.leftBackgoundImage)}j=d("<div>",{id:"pinify-doubleTopHat-leftBar"}).appendTo(l);d("<img>",{id:"pinify-doubleTopHat-logo",src:h.icon,alt:"Drag Me","class":"msPinSite"}).appendTo(j);m=d("<div>",{"class":"pinify-doubleTopHat-right"}).appendTo(i);if(h.style.rightBackgroundImage){d(m).css("background-image",h.style.rightBackgoundImage)}d("<div>",{id:"pinify-doubleTopHat-rightBar"}).appendTo(m);k=d("<div>",{id:"pinify-doubleTopHat-rightBarMainContent"}).appendTo(m);d("<div>",{"class":"pinify-mainText"}).text(h.pinText).appendTo(k);return d("<div>",{"class":"pinify-doubleTopHat-lighterText"}).text(h.secondaryText).appendTo(m)},hangingChad:function(){i.hide();i.css({color:h.style.textColor,"background-color":h.style.backgroundColor}).addClass("pinify-hanging-container pinify-teaser");d("<img>",{src:h.icon,"class":"msPinSite"}).appendTo(i);d("<div>",{"class":"pinify-hanging-content"}).appendTo(i);d("<div>",{id:"pinify-pinText"}).text(h.pinText).appendTo(i);return i.fadeIn("slow")}};h=d.extend({},f,h);return this.each(function(){g[h.type]();if(!h.sticky){this.delay(h.timeout).fadeOut("slow")}else{d("<div>").addClass("pinify-closePin").click(function(){d(".pinify-teaser").slideUp("slow");return i.slideUp("slow")}).appendTo(i)}if(!h.addStartLink){return}return d("<a>").addClass("pinify-addSiteLink").attr("href","#").click(function(j){j.preventDefault();try{return window.external.msAddSiteMode()}catch(k){}}).css("color",h.linkColor).appendTo(i).text(h.linkText)})}};d.fn.pinify=function(f){if(!a()){return this}if(b[f]){return b[f].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof f==="object"||!f){return b.init.apply(this,arguments)}else{return d.error("Method "+f+" does not exist on jQuery.pinify")}}};return d.pinify={firstRunState:function(f){if(!a()){return 0}if(f){f=false}return e(function(){return window.external.msIsSiteModeFirstRun(f)},0)},isPinned:function(){if(!a()){return false}return e(function(){return window.external.msIsSiteMode()},false)},addJumpList:function(g){var f;if(!a()){return false}f={title:"",items:[]};g=d.extend({},f,g);return e(function(){var h;if(window.external.msIsSiteMode()){window.external.msSiteModeClearJumpList();window.external.msSiteModeCreateJumpList(g.title);h=g.items;d.each(h,function(i,j){return window.external.msSiteModeAddJumpListItem(j.name,j.url,j.icon)});return window.external.msSiteModeShowJumpList()}})},clearJumpList:function(){if(!a()){return this}return e(function(){if(window.external.msIsSiteMode()){return window.external.msSiteModeClearJumpList()}})},addOverlay:function(g){var f;if(!a()){return this}f={title:"",icon:""};g=d.extend({},f,g);return e(function(){if(window.external.msIsSiteMode()){window.external.msSiteModeClearIconOverlay();return window.external.msSiteModeSetIconOverlay(g.icon,g.title)}})},clearOverlay:function(){if(!a()){return this}return e(function(){if(window.external.msIsSiteMode()){return window.external.msSiteModeClearIconOverlay()}})},flashTaskbar:function(){if(!a()){return this}return e(function(){if(window.external.msIsSiteMode()){return window.external.msSiteModeActivate()}})},createThumbbarButtons:function(g){var f;if(!a()){return this}f={buttons:[]};g=d.extend({},f,g);return e(function(){var h,j,i;if(window.external.msIsSiteMode()){j=[];h=(function(){function k(){}k.prototype.button=null;k.prototype.alternateStyle=null;k.prototype.activeStyle=0;k.prototype.click=null;return k})();i=function(k){var m,l;m=j[k.buttonID];m.click();if(m.alternateStyle){l=m.activeStyle===0?m.alternateStyle:0;window.external.msSiteModeShowButtonStyle(m.button,l);return m.activeStyle=l}};d.each(g.buttons,function(l,o){var n,k,p,m;k=window.external.msSiteModeAddThumbBarButton(o.icon,o.name);if(o.alternateStyle){m=o.alternateStyle;n=window.external.msSiteModeAddButtonStyle(k,m.icon,m.name)}p=new h;p.button=k;p.alternateStyle=n;p.click=o.click;j[k]=p;if(document.addEventListener){return document.addEventListener("msthumbnailclick",i,false)}else{if(document.attachEvent){return document.attachEvent("onmsthumbnailclick",i)}}});window.onunload=function(){var l,m,k;k=[];for(l in j){if(!__hasProp.call(j,l)){continue}m=j[l];k.push(window.external.msSiteModeUpdateThumbBarButton(j[l].button,true,false))}return k};window.onload=function(){var l,m,k;k=[];for(l in j){if(!__hasProp.call(j,l)){continue}m=j[l];k.push(window.external.msSiteModeUpdateThumbBarButtons(j[l].button,true,true))}return k};return window.external.msSiteModeShowThumbBar()}})}}})(jQuery);